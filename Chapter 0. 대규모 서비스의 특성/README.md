# 대규모 서비스의 특성

<br/>

## 대규모 서비스란

예) 페이스북/넷플릭스/배그/구글/트위터/네이버/카카오 등등

- 많은 사용자 트래픽
- 많은 사용자 데이터
- 사용자 데이터나 트래픽이 빠른속도로 증가

<br/>

#### 서비스 트래픽 증가 사례

- 페이스북 : 2012년 기준 하루에 500 테라바이트의 데이터가 쌓이고 있음
- bit.ly : 2011년 클릭(숏URL만들기) 횟수가 1년 사이에 2배 증가 (6천만번 > 1억 오천만번)
- 넷플릭스 : 2010년 기준 API 콜 수가 20배 증가

<br/>

#### 트래픽이 감당할 수 없이 증가해서 서비스가 며칠동안 먹통이 되는 것을 막기 위해 어떻게 서비스를 만들어야 할까.

<br/>

## 대규모 서비스가 가져야할 특성

### 1) 확장성

트래픽의 증감에 따라 서버를 늘이고 줄이는 것이 쉬워야 한다. 

확장 대상은 웹 서버 또는 디비 서버 등이다. 

<br/>

### 2) 장애회복성

서비스에 장애가 발생했을 때 자동으로 처리될 수 있어야 한다. 

문제가 발생한 서버가 자동으로 제거되고 후에 사람이 직접 수동으로 빼는 형태

<br/>

#### 장애회복성을 위해서는 SPOF가 없어야 한다 (최소한으로 해야한다)

(SPOF : Single Point Of Failure : 해당 지점에 장애가 발생하면 전체 서비스에 장애를 유발시킬 수 있는 부분)

- 한 대의 물리서버(예: 웹서버/디비서버)에는 SPOF가 존재한다. 
- SPOF를 줄이기 위해 웹서버/디비서버 등 모든 부분에서 최소 이중화가 되어야 한다. 
- 이 외에도 SPOF는 스위치/라우터 등의 하드웨어 쪽에서도 발생할 수 있다. 
  - 네트워크 스위치의 capacity (최대가용량) 고려 필요 
  - 서버들이 맞물린 스위치 등 하드웨어 장비도 이중화 필요

<br/>

### 3) 자동화

확장성/장애회복성을 위한 전제조건으로 배포부터 장애처리까지 대부분 자동화가 되어있어야 한다. 

서버 런칭/인프라 구성 등 예상가능한 많은 부분들이 버튼클릭이나 스크립트 한 두번으로 처리될 수 있어야 한다. 

수동으로 처리하는 것은 새로운 장애를 유발할 수 있음

- IaC (Infrastructre as code) 도구활용 : 인프라구축
- On-premis 서비스 준비(직접설치) : 인프라팀 장비준비/서비스설치/OS 네트워크 설정/설치스크립트 등 
- Cloud 서비스 준비 : 서버/그 외 클라우드 제공서비스 등 필요인프라는 IaC로 생성 (예: Terraform)

<br/>

### 4) 모니터링

서비스 상태는 항상 모니터링 되어야 한다. 

<br/>

## 실습과정

- Ansible과 Terraform을 이용해서 간단히 인프라 구축 
  - 수동으로 AWS Console에서 Ec2를 생성해도되지만 비용발생
  - Terraform : 해시코프에서 만든 IaC를 위한 도구 : AWS, GCP등 여러가지 클라우드를 다양하게 사용가능
- 리눅스나 Mac OS를 대상으로 함
- 파이썬 3.8.6

